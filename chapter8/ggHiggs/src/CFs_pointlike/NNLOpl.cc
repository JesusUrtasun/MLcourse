#include "CFs_pointlike.hh"
#include "../math/mellin_Dk.hh"
#include "NNLO_Exact_Mellin/Sigma2.hh"


// expansion of log^2(1/z)/z in powers of (1-z) from 0 to 37
double xlog3z_softexp[38] = {0, 0, 0, 1.000000000, 2.500000000, 4.250000000, 6.125000000, 8.058333333, 10.01250000, 11.96560847, 13.90459656, 15.82162037, 17.71202712, 19.57316709, 21.40367214, 23.20300448, 24.97116761, 26.70851738, 28.41563651, 30.09325030, 31.74216932, 33.36325037, 34.95736982, 36.52540532, 38.06822354, 39.58667196, 41.08157350, 42.55372335, 44.00388706, 45.43279972, 46.84116590, 48.22965997, 49.59892683, 50.94958283, 52.28221683, 53.59739137, 54.89564381, 56.17748753};
double xlog2z_softexp[38] = {0, 0, 1.000000000, 2.000000000, 2.916666667, 3.750000000, 4.511111111, 5.211111111, 5.859325397, 6.463293651, 7.029087302, 7.561626984, 8.064939875, 8.542356902, 8.996661725, 9.430203368, 9.844981992, 10.24271481, 10.62488732, 10.99279343, 11.34756740, 11.69020927, 12.02160551, 12.34254580, 12.65373676, 12.95581341, 13.24934866, 13.53486123, 13.81282242, 14.08366181, 14.34777206, 14.60551316, 14.85721599, 15.10318539, 15.34370294, 15.57902922, 15.80940597, 16.03505782};
double xlog1z_softexp[38] = {0, 1.000000000, 1.500000000, 1.833333333, 2.083333333, 2.283333333, 2.450000000, 2.592857143, 2.717857143, 2.828968254, 2.928968254, 3.019877345, 3.103210678, 3.180133755, 3.251562327, 3.318228993, 3.380728993, 3.439552523, 3.495108078, 3.547739657, 3.597739657, 3.645358705, 3.690813250, 3.734291511, 3.775958178, 3.815958178, 3.854419716, 3.891456753, 3.927171039, 3.961653798, 3.994987131, 4.027245195, 4.058495195, 4.088798226, 4.118209990, 4.146781419, 4.174559197, 4.201586224};
// expansion of log^2(1/z) in powers of (1-z) from 0 to 37
double log3z_softexp[38] = {0, 0, 0, 1.000000000, 1.500000000, 1.750000000, 1.875000000, 1.933333333, 1.954166667, 1.953108466, 1.938988095, 1.917023810, 1.890406746, 1.861139971, 1.830505051, 1.799332345, 1.768163132, 1.737349763, 1.707119136, 1.677613787, 1.648919015, 1.621081057, 1.594119446, 1.568035502, 1.542818225, 1.518448411, 1.494901547, 1.472149851, 1.450163703, 1.428912664, 1.408366181, 1.388494070, 1.369266859, 1.350655999, 1.332634005, 1.315174537, 1.298252435, 1.281843727};
double log2z_softexp[38] = {0, 0, 1.000000000, 1.000000000, 0.9166666667, 0.8333333333, 0.7611111111, 0.7000000000, 0.6482142857, 0.6039682540, 0.5657936508, 0.5325396825, 0.5033128908, 0.4774170274, 0.4543048222, 0.4335416435, 0.4147786242, 0.3977328227, 0.3821725025, 0.3679061135, 0.3547739657, 0.3426418721, 0.3313962459, 0.3209402826, 0.3111909593, 0.3020766542, 0.2935352444, 0.2855125716, 0.2779611967, 0.2708393820, 0.2641102532, 0.2577411052, 0.2517028247, 0.2459694058, 0.2405175427, 0.2353262852, 0.2303767455, 0.2256518485};
double log1z_softexp[38] = {0, 1.000000000, 0.5000000000, 0.3333333333, 0.2500000000, 0.2000000000, 0.1666666667, 0.1428571429, 0.1250000000, 0.1111111111, 0.1000000000, 0.09090909091, 0.08333333333, 0.07692307692, 0.07142857143, 0.06666666667, 0.06250000000, 0.05882352941, 0.05555555556, 0.05263157895, 0.05000000000, 0.04761904762, 0.04545454545, 0.04347826087, 0.04166666667, 0.04000000000, 0.03846153846, 0.03703703704, 0.03571428571, 0.03448275862, 0.03333333333, 0.03225806452, 0.03125000000, 0.03030303030, 0.02941176471, 0.02857142857, 0.02777777778, 0.02702702703};



// NLO
double eta1gg1  [38] = {-12, 24, 0, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12};
double eta1gg0  [38] = {6.,-3.,11.,0,4.2,6.3,7.7571428571428571,8.8928571428571429,9.8309523809523810,10.633333333333333,11.3359307359307359,11.961688311688312,12.5262570762570763,13.040842490842491,13.513769563769564,13.9514069264069264,14.3587,14.739766116236705,15.0977,15.435251152356416,15.7546083689272544,16.0577,16.346008806780782,16.621022923099246,16.883891359011160,17.135648732072881,17.377202057974033,17.609351020122995,17.832804348403909,18.048193174137563,18.256082010057544,18.4569778467014343,18.651337741534077,18.8395751919394587,19.022065519448762,19.199150444327804,19.371141992789941,19.5383};
double eta1gg0L1[38] = {-6.,12.,0,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.,6.};
double C1reg_pointlike_gg_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double res = 0;
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  for(int i=0; i<=truncation; i++) {
    res += (eta1gg1[i]*log(1-z) + eta1gg0[i] + eta1gg0L1[i]*lf) * pow(1-z,i);
  }
  return res;
}
double C1reg_pointlike_gg_smallx(double z, int nf, int truncation) {
  double c1 = 6;
  double c0 = -11./2.;
  double b1 = -6;
  double res = ( - c1*log(z) + c0 )/z - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c1*xlog1z_softexp[i] + c0 + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
double C1reg_pointlike_gg(double z, int nf, double muf_mH_ratio, double mur_muf_ratio) {
  double lf = -2.*log(muf_mH_ratio);
  double smallx = - 11./2.*pow(1.-z,3.)/z;
  double res = CA * 2.*( (1./z-2.+z*(1.-z))*(2.*log(1.-z)-log(z)) -log(z)/(1.-z) ) + smallx;
  return res + 2.*CA*(1./z-2.+z-z*z)*lf;
}
//
double eta1qg1  [38] = {1.33333333333333333,1.33333333333333333,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667,2.6666666666666667};
double eta1qg0  [38] = {0.666666666666666667,0,0,0.88888888888888889,1.3888888888888889,1.7444444444444444,2.0222222222222222,2.2507936507936508,2.4452380952380952,2.6145502645502646,2.7645502645502646,2.8992303992303992,3.0214526214526215,3.1333407333407333,3.23651533651533652,3.3322418322418322,3.4215275465275465,3.5051876772465008,3.5838913809502045,3.65819,3.72856515689333027,3.79539890793760763,3.85903527157397126,3.9197668105663798,3.97785,4.0334997925602314,4.08692,4.13827662067039282,4.18772717012094228,4.23540703389276007,4.28144,4.3259326620157186,4.3689882175712741,4.4106956141173803,4.4511367905879686,4.49038642983760782,4.52851279149338124,4.56557842855901831};
double eta1qg0L1[38] = {0.666666666666666667,0.666666666666666667,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333,1.33333333333333333};
double C1reg_pointlike_qg_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double res = 0;
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  for(int i=0; i<=truncation; i++) {
    res += (eta1qg1[i]*log(1-z) + eta1qg0[i] + eta1qg0L1[i]*lf) * pow(1-z,i);
  }
  return res;
}
double C1reg_pointlike_qg(double z, int nf, double muf_mH_ratio, double mur_muf_ratio) {
  double lf = -2.*log(muf_mH_ratio);
  double Pgq = CF*(1.+pow(1.-z,2))/z/2.;
  double smallx = 2./3.*z - pow(1.-z,2)/z;
  return Pgq*(2.*log(1-z)-log(z)+lf) + smallx;
}
//
double C1reg_pointlike_qqb_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double res = 0;
  for(int i=3; i<=truncation; i++) {
    res += pow(1-z,i);
  }
  return 32./27. * res;
}
double C1reg_pointlike_qqb(double z, int nf, double muF_mH_ratio, double mur_muf_ratio) {
  return 32./27.*pow(1-z,3)/z;
}








double eta2gg3A [39] = {-72., 144., 0., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72., 72.};
double eta2gg2A [39] = {172.5000000000000, -423.7500000000000, 255.7500000000000, -178.1250000000000, -80.47500000000000, -34.05000000000000, -2.571428571428571, 21.77678571428571, 41.87321428571429, 59.10000000000000, 74.23538961038961, 87.76607142857143, 100.0195679320679, 111.2284340659341, 121.5646478521479, 131.1594967532468, 140.1157911941000, 148.5157386730916, 156.4262262891907, 163.9024840291288, 170.9906972091376, 177.7299145707234, 184.1534709914194, 190.2900675470377, 196.1646045317921, 201.7988330206945, 207.2118709248193, 212.4206163460648, 217.4400820527718, 222.2836686385998, 226.9633894924586, 231.4900575164535, 235.8734412003447, 240.1223959398651, 244.2449751988415, 248.2485251415458, 252.1397656180804, 255.9248598122303, 259.6094744152660};
double eta2gg2F [39] = {-2.000000000000000, 5.333333333333333, 0, 3.333333333333333, 3.333333333333333, 3.377777777777778, 3.422222222222222, 3.460317460317460, 3.492063492063492, 3.518518518518519, 3.540740740740741, 3.559595959595960, 3.575757575757576, 3.589743589743590, 3.601953601953602, 3.612698412698413, 3.622222222222222, 3.630718954248366, 3.638344226579521, 3.645224171539961, 3.651461988304094, 3.657142857142857, 3.662337662337662, 3.667105841018884, 3.671497584541063, 3.675555555555556, 3.679316239316239, 3.682811016144349, 3.686067019400353, 3.689107827038862, 3.691954022988506, 3.694623655913978, 3.697132616487455, 3.699494949494949, 3.701723113487819, 3.703828197945845, 3.705820105820106, 3.707707707707708, 3.709498972656867};
double eta2gg2L1[38] = {-108.,216.,0,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.,108.};
double eta2gg1A [39] = {48.79406601634038, 596.1618679673192, -420.500000000000, 583.955933983660, 271.355933983660, 199.515933983660, 174.461648269374, 165.45797479999, 163.67396119454, 165.69744192017, 169.9412514440, 175.5659821930, 182.0843801587, 189.1934496365, 196.6948553828, 204.4536890262, 212.375502185, 220.392726212, 228.456237375, 236.529901941, 244.586929345, 252.607366355, 260.576335482, 268.482772525, 276.318506865, 284.077581897, 291.755746675, 299.350071501, 306.858654439, 314.280395351, 321.614820607, 328.861946203, 336.022170244, 343.096188057, 350.084924879, 356.989482281, 363.811095384, 370.551098626, 377.210898309};
double eta2gg1F [39] = {5.083333333333333, -17.41666666666667, 7.000000000000000, -9.333333333333333, -6.044444444444444, -4.736296296296296, -3.886878306878307, -3.226492819349962, -2.672600151171580, -2.190182245737801, -1.760709742931965, -1.372806127654613, -1.018762326338084, -0.692998501972861, -0.391288842754044, -0.110327688184831, 0.152534023710494, 0.399459339093134, 0.632241268283074, 0.852384738013348, 1.061166297788697, 1.259678707372206, 1.448864918301341, 1.629544418024440, 1.802433952653217, 1.968164034672098, 2.127292239297120, 2.280314019974754, 2.427671583776160, 2.569761232985297, 2.706939482195623, 2.839528189176340, 2.967818884985632, 3.092076449106901, 3.212542245185595, 3.329436809739034, 3.442962168213376, 3.553303838682288, 3.660632572380406};
double eta2gg1L1[38] = {149.,-390.33333333333333,231.,-173.83333333333333,-85.633333333333333,-43.711111111111111,-15.2888888888888889,6.6944444444444444,24.838888888888889,40.3925925925925926,54.0582491582491582,66.2752525252525253,77.339277389277389,87.460256410256410,96.793434343434343,105.45732323232323,113.54472896384661,121.12985968280086,128.273,135.02428979402664,141.42513832057176,147.51089058000823,153.31163948785096,158.85329517515882,164.15833689672228,169.24640115130827,174.135,178.83863163150977,183.37160736586481,187.74577313198460,191.97197508477165,196.05997564094517,200.01859436433031,203.85582650547611,207.57894334752084,211.194577631537481,214.708796663403571,218.12716518672566};
double eta2gg1L2[38] = {-36.,72.,0,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.,36.};
double eta2gg0A [39] = {-344.0668034585399, 315.515, 162.186, -259.927, 53.4202, 93.5392, 102.433, 104.855, 105.505, 105.569, 105.412, 105.163, 104.88, 104.594, 104.322, 104.078, 103.866, 103.693, 103.561, 103.471, 103.423, 103.415, 103.448, 103.519, 103.628, 103.771, 103.949, 104.158, 104.397, 104.665, 104.96, 105.28, 105.625, 105.992, 106.381, 106.79, 107.218, 107.664, 108.127};
double eta2gg0F [39] = {0.5676459114742307, 4.963129421253903, -10.0521, 6.28232, 0.226074, -1.15138, -1.77545, -2.14781, -2.39655, -2.57057, -2.69411, -2.78125, -2.84111, -2.87994, -2.90223, -2.91133, -2.90977, -2.89952, -2.88212, -2.85881, -2.83058, -2.79824, -2.76245, -2.72376, -2.68263, -2.63945, -2.59453, -2.54815, -2.50054, -2.4519, -2.40241, -2.35221, -2.30142, -2.25016, -2.19852, -2.14659, -2.09443, -2.04211, -1.98969};
double eta2gg0L1[38] = {37.3554,240.78926731699295,-192.75,242.76963365849648,102.94185588071870,64.367226251089070,46.6636,36.540433923046742,30.063515933628752,25.664812964786894,22.588613269420532,20.418919500320198,18.903455259174138,17.877862132132460,17.2291617592791566,16.876471646896965,16.7600403018259145,16.834618620231830,17.065246188021408,17.424460374776662,17.890384536292709,18.445381525569067,19.075083083512930,19.767676272056688,20.5134,21.303989651967701,22.132666640259909,22.993595284661812,23.881842818303198,24.793198117901956,25.724050635803431,26.671292662823016,27.632239838825516,28.604566059797184,29.586249834562915,30.5755,31.570867732149432,32.570917333802066};
double eta2gg0L2[38] = {23.75,-90.833333333333333,33.,-47.5833333333333333,-34.9833333333333333,-29.227777777777778,-25.4007936507936508,-22.4603174603174603,-20.0349206349206349,-17.951851851851852,-16.1162818662818663,-14.47,-12.9742590742590743,-11.601831501831502,-10.332622932622933,-9.15133477633477633,-8.0459911004028651,-7.0070088408323702,-6.0265794176010894,-5.0982426442952759,-4.2165842499433831,-3.3770156314273961,-2.57560994329401921,-1.8089777831835982,-1.07417133359453995,-0.36860935933691352,0.30998224229816638,0.96361811260070335,1.5940920575574069,2.2030086411866342,2.7918092485634374,3.36179375515806634,3.9141386726309037,4.44991244450524485,4.97008841812049741,5.4755559081468110,5.9671296820735261,6.44555813263819954};
double C2reg_pointlike_gg_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double l1mz = log(1-z);
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2gg3A [i]                 * pow(1-z,i) * l1mz*l1mz*l1mz;
    res += (eta2gg2A [i]+nf*eta2gg2F[i]) * pow(1-z,i) * l1mz*l1mz;
    res +=  eta2gg2L1[i]                 * pow(1-z,i) * l1mz*l1mz * lf;
    res += (eta2gg1A [i]+nf*eta2gg1F[i]) * pow(1-z,i) * l1mz;
    res +=  eta2gg1L1[i]                 * pow(1-z,i) * l1mz * lf;
    res +=  eta2gg1L2[i]                 * pow(1-z,i) * l1mz * lf*lf;
    res += (eta2gg0A [i]+nf*eta2gg0F[i]) * pow(1-z,i);
    res +=  eta2gg0L1[i]                 * pow(1-z,i) * lf;
    res +=  eta2gg0L2[i]                 * pow(1-z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_gg_smallx(double z, int nf, int truncation) {
  double c3 = 6;
  double c2 = -231./4.+17./18.*nf;
  double c1 = 2069./8.-18*ZETA2 - 641./108.*nf;
  double c0 = -6107./16. + 14939./1296.*nf + 45*ZETA2 - 17./9.*ZETA2*nf + 27./2.*ZETA3 - ZETA3/3.*nf;
  double b3 = 21./2-5./9*nf;
  double b2 = 111./8.+7./4.*nf;
  double b1 = 349./2.-54*ZETA2 - 26./3.*nf + 4*ZETA2*nf;
  double res = ( c3*pow(-log(z),3) + c2*pow(-log(z),2) - c1*log(z) + c0 )/z + b3*pow(-log(z),3) + b2*pow(-log(z),2) - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0 + b3*log3z_softexp[i] + b2*log2z_softexp[i] + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
dcomplex C2reg_pointlike_gg_softexp(dcomplex N, int nf, int truncation) {
  dcomplex res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2gg3A[i]                 * mell_L(i,3,N);
    res += (eta2gg2A[i]+nf*eta2gg2F[i]) * mell_L(i,2,N);
    res += (eta2gg1A[i]+nf*eta2gg1F[i]) * mell_L(i,1,N);
    res += (eta2gg0A[i]+nf*eta2gg0F[i]) * mell_L(i,0,N);
  }
  return res;
}
dcomplex C2reg_pointlike_gg_smallx(dcomplex N, int nf, int truncation) {
  double c3 = 6;
  double c2 = -231./4.+17./18.*nf;
  double c1 = 2069./8.-18*ZETA2 - 641./108.*nf;
  double c0 = -6107./16. + 14939./1296.*nf + 45*ZETA2 - 17./9.*ZETA2*nf + 27./2.*ZETA3 - ZETA3/3.*nf;
  double b3 = 21./2-5./9*nf;
  double b2 = 111./8.+7./4.*nf;
  double b1 = 349./2.-54*ZETA2 - 26./3.*nf + 4*ZETA2*nf;
  dcomplex res = c3*6./(N-1.)/(N-1.)/(N-1.)/(N-1.) + c2*2./(N-1.)/(N-1.)/(N-1.) + c1/(N-1.)/(N-1.) + c0/(N-1.) + b3*6./N/N/N/N + b2*2./N/N/N + b1/N/N;
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0) * mell_L(i,0,N);
    res -= ( b3* log3z_softexp[i] + b2* log2z_softexp[i] + b1* log1z_softexp[i]     ) * mell_L(i,0,N);
  }
  return res;
}

double eta2qg3A [39] = {6.796296296296296, 6.796296296296296, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259, 13.59259259259259};
double eta2qg2A [39] = {2.361111111111111, -14.13888888888889, -20.58333333333333, -8.21296296296296, 2.38425925925926, 10.01388888888889, 16.11851851851852, 21.25502645502646, 25.70773809523810, 29.64600970017637, 33.18073192239859, 36.38926166426166, 39.32806637806638, 42.03979908979909, 44.55755448255448, 46.90757483257483, 49.11104705479705, 51.18533899379488, 53.14487512306140, 55.0017722678842, 56.7663109293527, 58.4472911577014, 60.0523055877158, 61.5879519059708, 63.0600002883453, 64.4735268583936, 65.8330211603879, 67.1424735187291, 68.4054466567023, 69.6251348725591, 70.8044132889065, 71.9458791151331, 73.0518864329348, 74.1245756911079, 75.1658988491590, 76.1776409197246, 77.1614385128360, 78.1187958701933, 79.0510987871454};
double eta2qg2F [39] = {0.05555555555555556, 0.05555555555555556, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111, 0.1111111111111111};
double eta2qg2L1[38] = {10.3333333333333333,10.3333333333333333,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667,20.6666666666666667};
double eta2qg1A [39] = {2.472588517509853, 50.58369962862096, 68.00073259057526, 50.5562881461308, 37.5979548127975, 34.1910412325506, 33.6945597510691, 34.5437509831175, 36.1328682040799, 38.1636190229260, 40.4682552663122, 42.9445485178917, 45.5268477730697, 48.1714464748945, 50.8484983641259, 53.5372543799637, 56.2231165507515, 58.8957452432389, 61.5478054794737, 64.1741154453902, 66.7710558798600, 69.3361530357965, 71.8677796568892, 74.3649377167697, 76.8270987421462, 79.2540852833518, 81.6459821681111, 84.0030695618600, 86.3257721592650, 88.6146204191954, 90.8702208659973, 93.0932332667192, 95.2843530578510, 97.4442978036180, 99.5737967666719, 101.6735828925782, 103.7443866736690, 105.7869314809778, 107.8019300460176};
double eta2qg1F [39] = {-0.6666666666666667, -0.222222222222222, -1.111111111111111, -0.814814814814815, -0.648148148148148, -0.529629629629630, -0.437037037037037, -0.360846560846561, -0.296031746031746, -0.239594356261023, -0.189594356261023, -0.144700978034311, -0.103960237293571, -0.066664199997533, -0.032272665605999, -0.000363833697167, 0.029398071064738, 0.057284781304389, 0.083519349205624, 0.108287151063209, 0.131743941186666, 0.154021858201425, 0.175233979413546, 0.195477825744349, 0.214838095104618, 0.233388819742299, 0.251195087548567, 0.268314429112353, 0.284797945595870, 0.300691233519809, 0.316035148863724, 0.330866442894128, 0.345218294745980, 0.359120760261349, 0.372601152418212, 0.385684365501425, 0.398393152720016, 0.410748365075228, 0.422769157797775};
double eta2qg1L1[38] = {1.4444444444444444,-15.444444444444444,-24.111111111111111,-13.,-3.1111111111111111,4.01481481481481481,9.72592592592592593,14.538624338624339,18.715873015873016,22.414285714285714,25.736507936507937,28.7542408209074876,31.5198973865640532,34.0731219397886065,36.4447,38.659121125787793,40.7361052527719194,42.6918786732512223,44.539917888937497,46.291551875865601,47.9564,49.5426982603453192,51.0576,52.507171146557336,53.896938384150660,55.231624374488825,56.515442038306488,57.7521371950016451,58.9451,60.0971971300998944,61.2112639062356361,62.2897,63.334708680264392,64.348312459997204,65.3323439513816368,66.2884823663435812,67.218267613775888,68.123115318623592};
double eta2qg1L2[38] = {3.44444444444444444,3.44444444444444444,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889,6.8888888888888889};
double eta2qg0A [39] = {25.46012744620905, -10.99151113011625, -10.7892, 13.1887, 23.8509, 26.1397, 27.1995, 27.8593, 28.3411, 28.7358, 29.0888, 29.4251, 29.7585, 30.0972, 30.4456, 30.8058, 31.1789, 31.5649, 31.9637, 32.3746, 32.7969, 33.2297, 33.6723, 34.1238, 34.5835, 35.0507, 35.5245, 36.0044, 36.4898, 36.9801, 37.4747, 37.9733, 38.4754, 38.9806, 39.4885, 39.9987, 40.511, 41.0252, 41.5408};
double eta2qg0F [39] = {0.1604938271604938, 0.1604938271604938, 1.191358024691358, 0.475308641975309, 0.243827160493827, 0.138888888888889, 0.087654320987654, 0.064373897707231, 0.057385361552028, 0.060589359200470, 0.070479129923574, 0.084898455454011, 0.102453503286837, 0.122207823041156, 0.143512789385805, 0.165908007336579, 0.189060136292279, 0.212723893256690, 0.236716405273439, 0.260899885287673, 0.285169657477838, 0.309445712315591, 0.333666644917821, 0.357785235686413, 0.381765183283867, 0.405578659358751, 0.429204457870506, 0.452626580352170, 0.475833144626178, 0.498815536137175, 0.521567743085146, 0.544085832074060, 0.566367532086224, 0.588411902611311, 0.610219067617133, 0.631790001372139, 0.653126355349360, 0.674230317860607, 0.695104499902012};
double eta2qg0L1[38] = {0.0233312957919636024,24.134442406903075,32.046662591583927,22.281230492818495,13.901600863188866,10.354934196522199,8.3985144434357791,7.2461637253707753,6.5794844610724634,6.2338061485952091,6.1118661133218405,6.15140537316413062,6.31037820635413553,6.55928,6.87677197223313839,7.24709524729389819,7.6583575674252659,8.10145696409492405,8.56933120817783788,9.05644,9.5583861998712144,10.0716657067934905,10.593451902709345,11.121456924330199,11.6538179923528274,12.1890116993798238,12.725787650043359,13.2631,13.8001,14.336185193412564,14.870644073201368,15.403047399787743,15.9330001604577813,16.460177222091367,16.984311955022730,17.505186857759503,18.0226,18.536487544035310};
double eta2qg0L2[38] = {-0.94444444444444444,-4.3888888888888889,-7.3888888888888889,-6.2407407407407407,-4.6851851851851852,-3.55555555555555556,-2.6370370370370370,-1.85291005291005291,-1.1650793650793651,-0.550881834215167549,0.0046737213403880071,0.51219336219336219,0.97953342953342953,1.4127113627113627,1.8164557664557665,2.1945591445591446,2.5501147001147001,2.8856811489164430,3.2034008293812215,3.50508641589652942,3.7922858960784657,4.0663321227562714,4.3283811848053334,4.5794425228231932,4.8204028507400428,5.0520453628173375,5.2750653058372805,5.4900827164102467,5.6976529239804542,5.8982752759438024,6.0924004355862034,6.2804365250683440,6.46275432674098442,6.6396917113396593,6.8115574273230224,6.9786343591058365,7.14118234126166181,7.2994405995199201};
double C2reg_pointlike_qg_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double l1mz = log(1-z);
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2qg3A [i]                 * pow(1-z,i) * l1mz*l1mz*l1mz;
    res += (eta2qg2A [i]+nf*eta2qg2F[i]) * pow(1-z,i) * l1mz*l1mz;
    res +=  eta2qg2L1[i]                 * pow(1-z,i) * l1mz*l1mz * lf;
    res += (eta2qg1A [i]+nf*eta2qg1F[i]) * pow(1-z,i) * l1mz;
    res +=  eta2qg1L1[i]                 * pow(1-z,i) * l1mz * lf;
    res +=  eta2qg1L2[i]                 * pow(1-z,i) * l1mz * lf*lf;
    res += (eta2qg0A [i]+nf*eta2qg0F[i]) * pow(1-z,i);
    res +=  eta2qg0L1[i]                 * pow(1-z,i) * lf;
    res +=  eta2qg0L2[i]                 * pow(1-z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qg_smallx(double z, int nf, int truncation) {
  double c3 = 2;
  double c2 = -31./2+2./9.*nf;
  double c1 = 11021./162. - 29./27.*nf - 52.*ZETA2/9.;
  double c0 = -199423./1944. + 265./162.*nf + 221*ZETA2/27. + 92.*ZETA3/9.;
  double b3 = 71./27.;
  double b2 = 83./9.-2./9.*nf;
  double b1 = 905./18. + 26.*nf/27. - 140*ZETA2/9.;
  double res = ( c3*pow(-log(z),3) + c2*pow(-log(z),2) - c1*log(z) + c0 )/z + b3*pow(-log(z),3) + b2*pow(-log(z),2) - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0 + b3*log3z_softexp[i] + b2*log2z_softexp[i] + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
dcomplex C2reg_pointlike_qg_softexp(dcomplex N, int nf, int truncation) {
  dcomplex res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2qg3A[i]                 * mell_L(i,3,N);
    res += (eta2qg2A[i]+nf*eta2qg2F[i]) * mell_L(i,2,N);
    res += (eta2qg1A[i]+nf*eta2qg1F[i]) * mell_L(i,1,N);
    res += (eta2qg0A[i]+nf*eta2qg0F[i]) * mell_L(i,0,N);
  }
  return res;
}
dcomplex C2reg_pointlike_qg_smallx(dcomplex N, int nf, int truncation) {
  double c3 = 2;
  double c2 = -31./2+2./9.*nf;
  double c1 = 11021./162. - 29./27.*nf - 52.*ZETA2/9.;
  double c0 = -199423./1944. + 265./162.*nf + 221*ZETA2/27. + 92.*ZETA3/9.;
  double b3 = 71./27.;
  double b2 = 83./9.-2./9.*nf;
  double b1 = 905./18. + 26.*nf/27. - 140*ZETA2/9.;
  dcomplex res = c3*6./(N-1.)/(N-1.)/(N-1.)/(N-1.) + c2*2./(N-1.)/(N-1.)/(N-1.) + c1/(N-1.)/(N-1.) + c0/(N-1.) + b3*6./N/N/N/N + b2*2./N/N/N + b1/N/N;
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0) * mell_L(i,0,N);
    res -= ( b3* log3z_softexp[i] + b2* log2z_softexp[i] + b1* log1z_softexp[i]     ) * mell_L(i,0,N);
  }
  return res;
}

double eta2qqb2A [39] = {0, 1.777777777777778, 2.666666666666667, 9.580246913580247, 10.91358024691358, 12.03950617283951, 13.01728395061728, 13.88077601410935, 14.65326278659612, 15.35167548500882, 15.98871252204586, 16.57412217412217, 17.11553631553632, 17.61903281903282, 18.08952528952529, 18.53103933103933, 18.94691234691235, 19.33994066935243, 19.71248968896028, 20.06657752292427, 20.40393944625111, 20.72607812628452, 21.03430323450963, 21.32976300823028, 21.61346963976299, 21.88631988130889, 22.14911190410091, 22.40255919754820, 22.64730210895778, 22.88391748733561, 23.11292679220699, 23.33480295090183, 23.54997618865572, 23.75883901042176, 23.96175047803911, 24.15903989885795, 24.35101002023983, 24.53793980716962, 24.72008686650966};
double eta2qqb1A [39] = {0, -1.777777777777778, -2.666666666666667, -27.42386831275720, -23.20164609053498, -21.08411522633745, -19.48016460905350, -18.08144452842866, -16.79351305954481, -15.57961647210324, -14.42264998180342, -13.31329703271983, -12.24571419779693, -11.21577821821060, -10.22030895180116, -9.256697824087471, -8.322716990106637, -7.416413991839010, -6.536049125289343, -5.680055298934234, -4.847010393104761, -4.035616974049894, -3.244686601328279, -2.473127183315688, -1.719932476671076, -0.9841731747426066, -0.2649892265473335, 0.4384168572400774, 1.126785885182945, 1.800807182663044, 2.461123206780619, 3.108333659035046, 3.742999161682495, 4.365644552734820, 4.976761846079153, 5.576812896428900, 6.166231803297724, 6.745427083611307, 7.314783638726931};
double eta2qqb1F [39] = {0, 0, 0, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617, 0.3950617283950617};
double eta2qqb1L1[38] = {0,1.77777777777777778,2.6666666666666667,7.60493827160493827,8.93827,10.064197530864198,11.041975308641975,11.905467372134039,12.677954144620811,13.376366843033510,14.013403880070547,14.598813532146866,15.140227673561007,15.643724177057510,16.1142166475499809,16.5557306890640224,16.971603704937038,17.364632027377125,17.737181046984969,18.091268880948964,18.428630804275799,18.7508,19.058994592534324,19.354454366254968,19.6382,19.911011239333580,20.173803262125603,20.4273,20.672,20.908608845360305,21.1376181502316783,21.3594943089265245,21.5746675466804074,21.7835,21.986441836063805,22.183731256882638,22.375701378264524,22.562631165194311};
double eta2qqb0A [39] = {0, -0.7021050077301803, 1.76166, 32.4019, 16.4185, 10.345, 6.79417, 4.34848, 2.52026, 1.08749, -0.0695119, -1.02289, -1.81969, -2.49244, -3.06461, -3.55373, -3.97325, -4.33372, -4.64358, -4.90967, -5.13762, -5.3321, -5.49705, -5.63579, -5.75117, -5.84563, -5.9213, -5.98002, -6.0234, -6.05286, -6.06965, -6.07488, -6.06955, -6.05454, -6.03065, -5.99857, -5.95897, -5.91242, -5.85945};
double eta2qqb0F [39] = {0, 0, 0, -1.316872427983539, -0.526748971193416, -0.141563786008230, 0.108641975308642, 0.292063492063492, 0.435978835978836, 0.553948657652361, 0.653654712913972, 0.739849999109258, 0.815669926781038, 0.883286261064039, 0.944262322040100, 0.999759088647978, 1.050661272883495, 1.097657849291836, 1.141295386611291, 1.182014468266045, 1.220175229646621, 1.256075680361886, 1.289965117760095, 1.322054123762145, 1.352522134906485, 1.381523257240940, 1.409190790995430, 1.435640792754074, 1.460974909940043, 1.485282658385723, 1.508643268889799, 1.531127196750070, 1.552797365250050, 1.573710197273993, 1.593916476809811, 1.613462072825995, 1.632388551011733, 1.650733693539882, 1.668531942917078};
double eta2qqb0L1[38] = {0,-0.88888888888888889,-1.33333333333333333,-12.7572,-11.436213991769547,-10.891028806584362,-10.4709465020576132,-10.076348366507097,-9.6863508860334257,-9.2973136250384928,-8.9097768819461941,-8.5250966662895475,-8.1445413131752718,-7.76908812956358004,-7.39942,-7.03599120116750634,-6.67905369422999941,-6.3287344391049004,-5.9850580979788604,-5.64798,-5.3173991836696220,-4.9931901439339518,-4.6752,-4.3632554520509651,-4.0571862465514928,-3.7568106213521537,-3.4619479919838618,-3.17241933720281509,-2.8880488089712929,-2.6086648436561388,-2.3341009040496612,-2.06419594845623737,-1.7987946985263799,-1.53774775936916356,-1.2809116320077515,-1.02814864821306666,-0.77932685025236650,-0.53431983246397535};
double eta2qqb0L2[38] = {0,0.444444444444444444,0.666666666666666667,1.1111111111111111,1.4444444444444444,1.7259259259259259,1.9703703703703704,2.1862433862433862,2.3793650793650794,2.55396825396825397,2.7132275132275132,2.8595799262465929,2.9949334616001283,3.1208075874742541,3.2384307050973718,3.34880921547588214,3.45277746944413611,3.55103,3.6441718049561187,3.7326937634471174,3.8170342442788263,3.8975689142871805,3.97463,4.0484901347736184,4.11941679265679804,4.18762935304327147,4.2533273587412772,4.3166891821031005,4.37787490995549505,4.4370287545499527,4.4942810807677961,4.5497501204415077,4.6035434298799784,4.6557591353214903,4.70648700222582778,4.75580935743053592,4.80380188777600744,4.8505343345084542};
double C2reg_pointlike_qqb_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double l1mz = log(1-z);
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2qqb2A [i]                  * pow(1-z,i) * l1mz*l1mz;
    res += (eta2qqb1A [i]+nf*eta2qqb1F[i]) * pow(1-z,i) * l1mz;
    res +=  eta2qqb1L1[i]                  * pow(1-z,i) * l1mz * lf;
    res += (eta2qqb0A [i]+nf*eta2qqb0F[i]) * pow(1-z,i);
    res +=  eta2qqb0L1[i]                  * pow(1-z,i) * lf;
    res +=  eta2qqb0L2[i]                  * pow(1-z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qqb_smallx(double z, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 10./3. + 16.*nf/27. - 32*ZETA2/9.;
  double c0 = 964./81. - 184.*nf/243. + 80*ZETA2/81. - 32*ZETA3/27.;
  double b3 = 16./27.;
  double b2 = -80./27.;
  double b1 = 512./9. - 80.*nf/27. - 32*ZETA2/9.;
  double res = ( c3*pow(-log(z),3) + c2*pow(-log(z),2) - c1*log(z) + c0 )/z + b3*pow(-log(z),3) + b2*pow(-log(z),2) - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0 + b3*log3z_softexp[i] + b2*log2z_softexp[i] + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
dcomplex C2reg_pointlike_qqb_softexp(dcomplex N, int nf, int truncation) {
  dcomplex res = 0;
  for(int i=0; i<=truncation; i++) {
    res +=  eta2qqb2A[i]                  * mell_L(i,2,N);
    res += (eta2qqb1A[i]+nf*eta2qqb1F[i]) * mell_L(i,1,N);
    res += (eta2qqb0A[i]+nf*eta2qqb0F[i]) * mell_L(i,0,N);
  }
  return res;
}
dcomplex C2reg_pointlike_qqb_smallx(dcomplex N, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 10./3. + 16.*nf/27. - 32*ZETA2/9.;
  double c0 = 964./81. - 184.*nf/243. + 80*ZETA2/81. - 32*ZETA3/27.;
  double b3 = 16./27.;
  double b2 = -80./27.;
  double b1 = 512./9. - 80.*nf/27. - 32*ZETA2/9.;
  dcomplex res = c3*6./(N-1.)/(N-1.)/(N-1.)/(N-1.) + c2*2./(N-1.)/(N-1.)/(N-1.) + c1/(N-1.)/(N-1.) + c0/(N-1.) + b3*6./N/N/N/N + b2*2./N/N/N + b1/N/N;
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0) * mell_L(i,0,N);
    res -= ( b3* log3z_softexp[i] + b2* log2z_softexp[i] + b1* log1z_softexp[i]     ) * mell_L(i,0,N);
  }
  return res;
}

double eta2qq2A [39] = {0, 1.777777777777778, 2.666666666666667, 4.444444444444444, 5.777777777777778, 6.903703703703704, 7.881481481481481, 8.744973544973545, 9.517460317460317, 10.21587301587302, 10.85291005291005, 11.43831970498637, 11.97973384640051, 12.48323034989702, 12.95372282038949, 13.39523686190353, 13.81110987777654, 14.20413820021663, 14.57668721982447, 14.93077505378847, 15.26813697711531, 15.59027565714872, 15.89850076537383, 16.19396053909447, 16.47766717062719, 16.75051741217309, 17.01330943496511, 17.26675672841240, 17.51149963982198, 17.74811501819981, 17.97712432307118, 18.19900048176603, 18.41417371951991, 18.62303654128596, 18.82594800890331, 19.02323742972214, 19.21520755110403, 19.40213733803382, 19.58428439737386};
double eta2qq1A [39] = {0, -1.777777777777778, -2.666666666666667, -5.037037037037037, -5.555555555555556, -5.571358024691358, -5.310617283950617, -4.882620307382212, -4.350949861426052, -3.754729150919627, -3.118867892836147, -2.459645882772386, -1.787922880746354, -1.11105605422918, -0.43408310631606, 0.23952666472961, 0.90738349925311, 1.56785186737238, 2.21982974126490, 2.86259623640163, 3.49570484542518, 4.11890762326796, 4.73210072351546, 5.33528487750061, 5.92853646768037, 6.51198620048768, 7.08580328795377, 7.65018366036979, 8.20534115361964, 8.75150090816796, 9.28889442332641, 9.81775585756552, 10.33831927147240, 10.85081658678525, 11.35547609119235, 11.85252136010494, 12.34217049748722, 12.82463562093993, 13.30012253364790};
double eta2qq1L1[38] = {0,1.77777777777777778,2.6666666666666667,4.44444444444444444,5.7777777777777778,6.9037,7.8814814814814815,8.7449735449735450,9.5174603174603175,10.215873015873016,10.852910052910053,11.438319704986372,11.979733846400513,12.483230349897017,12.953722820389487,13.3952368619035286,13.811109877776544,14.204138200216632,14.576687219824475,14.9307750537884697,15.268136977115305,15.590275657148722,15.898500765373830,16.193960539094474,16.4776671706271922,16.750517412173086,17.013309434965109,17.266756728412402,17.511499639821980,17.748115018199811,17.977124323071185,18.199000481766031,18.414173719519914,18.623036541285961,18.8259480089033111,19.023237429722144,19.215207551104030,19.402137338033817};
double eta2qq0A [39] = {0, -0.7021050077301803, 0.206102, 0.960787, 0.684208, 0.484266, 0.359348, 0.302794, 0.306418, 0.361516, 0.459951, 0.594609, 0.759465, 0.949491, 1.16052, 1.38909, 1.63235, 1.8879, 2.15375, 2.42822, 2.70991, 2.99761, 3.29032, 3.58717, 3.88741, 4.19042, 4.49565, 4.80263, 5.11094, 5.42023, 5.73019, 6.04057, 6.35111, 6.66162, 6.97192, 7.28185, 7.59128, 7.90009, 8.20818};
double eta2qq0L1[38] = {0,-0.88888888888888889,-1.33333333333333333,-2.5185185185185185,-2.7777777777777778,-2.7856790123456790,-2.6553086419753086,-2.4413101536911061,-2.17547493071302595,-1.8773645754598136,-1.55943,-1.2298229413861930,-0.89396144037317679,-0.55552802711458870,-0.21704155315802928,0.11976333236480497,0.45369174962655556,0.783926,1.1099148706324524,1.4312981182008131,1.74785,2.0594538116339804,2.3660503617577309,2.6676424387503074,2.96426823384018562,3.2559931002438385,3.5429016439768853,3.8250918301848955,4.1026705768098213,4.37575045408397803,4.64445,4.9088779287827616,5.1691596357361981,5.4254082933926240,5.6777380455961745,5.9262606800524708,6.1710852487436105,6.4123178104699639};
double eta2qq0L2[38] = {0,0.444444444444444444,0.666666666666666667,1.1111111111111111,1.4444444444444444,1.7259259259259259,1.9703703703703704,2.1862433862433862,2.3793650793650794,2.55396825396825397,2.7132275132275132,2.8595799262465929,2.9949334616001283,3.1208075874742541,3.2384307050973718,3.34880921547588214,3.45277746944413611,3.55103,3.6441718049561187,3.7326937634471174,3.8170342442788263,3.8975689142871805,3.97463,4.0484901347736184,4.11941679265679804,4.18762935304327147,4.2533273587412772,4.3166891821031005,4.37787490995549505,4.4370287545499527,4.4942810807677961,4.5497501204415077,4.6035434298799784,4.6557591353214903,4.70648700222582778,4.75580935743053592,4.80380188777600744,4.8505343345084542};
double C2reg_pointlike_qq_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double l1mz = log(1-z);
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  for(int i=0; i<=truncation; i++) {
    res += eta2qq2A [i] * pow(1-z,i) * l1mz*l1mz;
    res += eta2qq1A [i] * pow(1-z,i) * l1mz;
    res += eta2qq1L1[i] * pow(1-z,i) * l1mz * lf;
    res += eta2qq0A [i] * pow(1-z,i);
    res += eta2qq0L1[i] * pow(1-z,i) * lf;
    res += eta2qq0L2[i] * pow(1-z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qq_smallx(double z, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 118./9. - 32*ZETA2/9.;
  double c0 = -640./27. + 16*ZETA2/3. - 16*ZETA3/27.;
  double b3 = 16./27.;
  double b2 = 112./27.;
  double b1 = 488./27. - 32*ZETA2/9.;
  double res = ( c3*pow(-log(z),3) + c2*pow(-log(z),2) - c1*log(z) + c0 )/z + b3*pow(-log(z),3) + b2*pow(-log(z),2) - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0 + b3*log3z_softexp[i] + b2*log2z_softexp[i] + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
dcomplex C2reg_pointlike_qq_softexp(dcomplex N, int nf, int truncation) {
  dcomplex res = 0;
  for(int i=0; i<=truncation; i++) {
    res += eta2qq2A[i] * mell_L(i,2,N);
    res += eta2qq1A[i] * mell_L(i,1,N);
    res += eta2qq0A[i] * mell_L(i,0,N);
  }
  return res;
}
dcomplex C2reg_pointlike_qq_smallx(dcomplex N, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 118./9. - 32*ZETA2/9.;
  double c0 = -640./27. + 16*ZETA2/3. - 16*ZETA3/27.;
  double b3 = 16./27.;
  double b2 = 112./27.;
  double b1 = 488./27. - 32*ZETA2/9.;
  dcomplex res = c3*6./(N-1.)/(N-1.)/(N-1.)/(N-1.) + c2*2./(N-1.)/(N-1.)/(N-1.) + c1/(N-1.)/(N-1.) + c0/(N-1.) + b3*6./N/N/N/N + b2*2./N/N/N + b1/N/N;
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0) * mell_L(i,0,N);
    res -= ( b3* log3z_softexp[i] + b2* log2z_softexp[i] + b1* log1z_softexp[i]     ) * mell_L(i,0,N);
  }
  return res;
}

double eta2qqp2A [39] = {0, 1.777777777777778, 2.666666666666667, 4.444444444444444, 5.777777777777778, 6.903703703703704, 7.881481481481481, 8.744973544973545, 9.517460317460317, 10.21587301587302, 10.85291005291005, 11.43831970498637, 11.97973384640051, 12.48323034989702, 12.95372282038949, 13.39523686190353, 13.81110987777654, 14.20413820021663, 14.57668721982447, 14.93077505378847, 15.26813697711531, 15.59027565714872, 15.89850076537383, 16.19396053909447, 16.47766717062719, 16.75051741217309, 17.01330943496511, 17.26675672841240, 17.51149963982198, 17.74811501819981, 17.97712432307118, 18.19900048176603, 18.41417371951991, 18.62303654128596, 18.82594800890331, 19.02323742972214, 19.21520755110403, 19.40213733803382, 19.58428439737386};
double eta2qqp1A [39] = {0, -1.777777777777778, -2.666666666666667, -5.037037037037037, -5.555555555555556, -5.571358024691358, -5.310617283950617, -4.882620307382212, -4.350949861426052, -3.754729150919627, -3.118867892836147, -2.459645882772386, -1.787922880746354, -1.111056054229177, -0.4340831063160585, 0.2395266647296099, 0.9073834992531111, 1.567851867372383, 2.219829741264905, 2.862596236401626, 3.495704845425177, 4.118907623267961, 4.732100723515462, 5.335284877500615, 5.928536467680371, 6.511986200487677, 7.085803287953771, 7.650183660369791, 8.205341153619643, 8.751500908167956, 9.288894423326411, 9.817755857565523, 10.33831927147240, 10.85081658678525, 11.35547609119235, 11.85252136010494, 12.34217049748722, 12.82463562093993, 13.30012253364790};
double eta2qqp1L1[38] = {0,1.77777777777777778,2.6666666666666667,4.44444444444444444,5.7777777777777778,6.9037,7.8814814814814815,8.7449735449735450,9.5174603174603175,10.215873015873016,10.852910052910053,11.438319704986372,11.979733846400513,12.483230349897017,12.953722820389487,13.3952368619035286,13.811109877776544,14.204138200216632,14.576687219824475,14.9307750537884697,15.268136977115305,15.590275657148722,15.898500765373830,16.193960539094474,16.4776671706271922,16.750517412173086,17.013309434965109,17.266756728412402,17.511499639821980,17.748115018199811,17.977124323071185,18.199000481766031,18.414173719519914,18.623036541285961,18.8259480089033111,19.023237429722144,19.215207551104030,19.402137338033817};
double eta2qqp0A [39] = {0, -0.7021050077301803, 0.280176, 1.18301, 1.01446, 0.898463, 0.840281, 0.837813, 0.886078, 0.978631, 1.10895, 1.27108, 1.45987, 1.67094, 1.90064, 2.14589, 2.40414, 2.67325, 2.95143, 3.23716, 3.52917, 3.82639, 4.12789, 4.43289, 4.74072, 5.0508, 5.36264, 5.67581, 5.98994, 6.30471, 6.61984, 6.93509, 7.25026, 7.56514, 7.8796, 8.19349, 8.50668, 8.81908, 9.13058};
double eta2qqp0L1[38] = {0,-0.88888888888888889,-1.33333333333333333,-2.5185185185185185,-2.7777777777777778,-2.7856790123456790,-2.6553086419753086,-2.4413101536911061,-2.17547493071302595,-1.8773645754598136,-1.55943,-1.2298229413861930,-0.89396144037317679,-0.55552802711458870,-0.21704155315802928,0.11976333236480497,0.45369174962655556,0.783926,1.1099148706324524,1.4312981182008131,1.74785,2.0594538116339804,2.3660503617577309,2.6676424387503074,2.96426823384018562,3.2559931002438385,3.5429016439768853,3.8250918301848955,4.1026705768098213,4.37575045408397803,4.64445,4.9088779287827616,5.1691596357361981,5.4254082933926240,5.6777380455961745,5.9262606800524708,6.1710852487436105,6.4123178104699639};
double eta2qqp0L2[38] = {0,0.444444444444444444,0.666666666666666667,1.1111111111111111,1.4444444444444444,1.7259259259259259,1.9703703703703704,2.1862433862433862,2.3793650793650794,2.55396825396825397,2.7132275132275132,2.8595799262465929,2.9949334616001283,3.1208075874742541,3.2384307050973718,3.34880921547588214,3.45277746944413611,3.55103,3.6441718049561187,3.7326937634471174,3.8170342442788263,3.8975689142871805,3.97463,4.0484901347736184,4.11941679265679804,4.18762935304327147,4.2533273587412772,4.3166891821031005,4.37787490995549505,4.4370287545499527,4.4942810807677961,4.5497501204415077,4.6035434298799784,4.6557591353214903,4.70648700222582778,4.75580935743053592,4.80380188777600744,4.8505343345084542};
double C2reg_pointlike_qqp_softexp(double z, int nf, double muF_mH_ratio, int truncation) {
  double l1mz = log(1-z);
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  for(int i=0; i<=truncation; i++) {
    res += eta2qqp2A [i] * pow(1-z,i) * l1mz*l1mz;
    res += eta2qqp1A [i] * pow(1-z,i) * l1mz;
    res += eta2qqp1L1[i] * pow(1-z,i) * l1mz * lf;
    res += eta2qqp0A [i] * pow(1-z,i);
    res += eta2qqp0L1[i] * pow(1-z,i) * lf;
    res += eta2qqp0L2[i] * pow(1-z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qqp_smallx(double z, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 118./9. - 32*ZETA2/9.;
  double c0 = -70./3. + 16*ZETA2/3.;
  double b3 = 16./27.;
  double b2 = 32./9.;
  double b1 = 152./9. - 32*ZETA2/9.;
  double res = ( c3*pow(-log(z),3) + c2*pow(-log(z),2) - c1*log(z) + c0 )/z + b3*pow(-log(z),3) + b2*pow(-log(z),2) - b1*log(z);
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0 + b3*log3z_softexp[i] + b2*log2z_softexp[i] + b1*log1z_softexp[i] ) * pow(1-z,i);
  }
  return res;
}
dcomplex C2reg_pointlike_qqp_softexp(dcomplex N, int nf, int truncation) {
  dcomplex res = 0;
  for(int i=0; i<=truncation; i++) {
    res += eta2qqp2A[i] * mell_L(i,2,N);
    res += eta2qqp1A[i] * mell_L(i,1,N);
    res += eta2qqp0A[i] * mell_L(i,0,N);
  }
  return res;
}
dcomplex C2reg_pointlike_qqp_smallx(dcomplex N, int nf, int truncation) {
  double c3 = 16./27.;
  double c2 = -8./3.;
  double c1 = 118./9. - 32*ZETA2/9.;
  double c0 = -70./3. + 16*ZETA2/3.;
  double b3 = 16./27.;
  double b2 = 32./9.;
  double b1 = 152./9. - 32*ZETA2/9.;
  dcomplex res = c3*6./(N-1.)/(N-1.)/(N-1.)/(N-1.) + c2*2./(N-1.)/(N-1.)/(N-1.) + c1/(N-1.)/(N-1.) + c0/(N-1.) + b3*6./N/N/N/N + b2*2./N/N/N + b1/N/N;
  for(int i=0; i<=truncation; i++) {
    res -= ( c3*xlog3z_softexp[i] + c2*xlog2z_softexp[i] + c1*xlog1z_softexp[i] + c0) * mell_L(i,0,N);
    res -= ( b3* log3z_softexp[i] + b2* log2z_softexp[i] + b1* log1z_softexp[i]     ) * mell_L(i,0,N);
  }
  return res;
}





////////////////////////
//                    //
// EXPANSION in z=1/2 //
//                    //
////////////////////////

namespace NLOcoeffs_05 {
  //
  // expansion coefficients of 16z^2(1-z)^2*C(z) in powers of w=1-2z
  //
  double eta1gg  [51] = {5.90305,-5.6355323334386875,8.85863,20.635532333438687,-11.0514,-4.200000000000000,-0.160279,-5.542857142857143,-0.683929,-1.666666666666667,-0.524405,-0.847619047619048,-0.372348484848485,-0.519081,-0.273164335664336,-0.352048,-0.207760989010989,-0.254986,-0.162937675070028,-0.193419068032071,-0.13104728733599,-0.151850213769718,-0.107611,-0.122434195229995,-0.0899092,-0.100839846652204,-0.076223,-0.084512395816743,-0.065429292929293,-0.071863701848710,-0.056769714959370,-0.061863446157106,-0.049718207960004,-0.053819058212829,-0.043900863131176,-0.0472508,-0.039046186656481,-0.0418178,-0.034953278964502,-0.0372724,-0.031470947608719,-0.033430795690103,-0.028483674006780,-0.03015477876510,-0.025902,-0.027338364037173,-0.0236557,-0.024899333374134,-0.0216892,-0.022773083159215,-0.019957992153215};
  double eta1ggL1[51] = {1.5,12.,7.5,-12.,-7.5,0.,-1.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  //
  double eta1qg  [51] = {-1.32191,1.54932324536012761,4.9621,1.5529610277865573,-1.22352,-1.85228,-1.21111,-0.407937,-0.3805555555555555,-0.205159,-0.196031746031746,-0.1240259740259741,-0.1203823953823954,-0.083313908313908,-0.0815962,-0.059906759906760,-0.0589952,-0.0451833,-0.0446557,-0.0353093,-0.0349831,-0.0283607,-0.0281483566313288,-0.023283615274462,-0.023139452716112,-0.019460129242738,-0.019358853706680,-0.016508338682252,-0.016435118826423,-0.014181648491993,-0.014127405161888,-0.012314999300539,-0.012273962545097,-0.010794491474414,-0.0107629,-0.0095394511665859,-0.0095147,-0.008491431653196,-0.00847178,-0.007607243210958,-0.007591440486177,-0.006854407977643,-0.006841557098297,-0.006208120691507,-0.006197563387013,-0.005649170581105,-0.005640417164746,-0.00516249,-0.005155172945817,-0.00473613,-0.004729967842826};
  double eta1qgL1[51] = {1.66666666666666667,2.33333333333333334,-0.6666666666666667,-2.0000000000000000,-1.0000000000000000,-0.3333333333333333,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  //
  double eta1qqb  [51] = {0.29629629629629630,1.18518518518518519,1.48148,0.,-1.48148,-1.18519,-0.296296,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  //
}
 

double C1reg_pointlike_gg_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NLOcoeffs_05::eta1gg  [i] * pow(1-2*z,i);
    res += NLOcoeffs_05::eta1ggL1[i] * pow(1-2*z,i) * lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C1reg_pointlike_qg_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NLOcoeffs_05::eta1qg  [i] * pow(1-2*z,i);
    res += NLOcoeffs_05::eta1qgL1[i] * pow(1-2*z,i) * lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C1reg_pointlike_qqb_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NLOcoeffs_05::eta1qqb  [i] * pow(1-2*z,i);
  }
  return res / (1-z)/(1-z)/z/z/16.;
}

double C1reg_pointlike_gg_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta1[51], eta1L1[51];
  for(int p=0; p<=truncation; p++) {
    eta1  [p] = 0;
    eta1L1[p] = 0;
    for(int k=0; k<=p; k++) {
      eta1  [p] += NLOcoeffs_05::eta1gg  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta1L1[p] += NLOcoeffs_05::eta1ggL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta1  [i] * pow(1-2*z,i);
    res += eta1L1[i] * pow(1-2*z,i) * lf;
  }
  return res;
}
double C1reg_pointlike_qg_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta1[51], eta1L1[51];
  for(int p=0; p<=truncation; p++) {
    eta1  [p] = 0;
    eta1L1[p] = 0;
    for(int k=0; k<=p; k++) {
      eta1  [p] += NLOcoeffs_05::eta1qg  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta1L1[p] += NLOcoeffs_05::eta1qgL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta1  [i] * pow(1-2*z,i);
    res += eta1L1[i] * pow(1-2*z,i) * lf;
  }
  return res;
}
double C1reg_pointlike_qqb_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double eta1[51];
  for(int p=0; p<=truncation; p++) {
    eta1  [p] = 0;
    for(int k=0; k<=p; k++) {
      eta1  [p] += NLOcoeffs_05::eta1qqb  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta1  [i] * pow(1-2*z,i);
  }
  return res;
}



namespace NNLOcoeffs_05 {
  //
  // expansion coefficients of 16z^2(1-z)^2*C(z) in powers of w=1-2z
  //
  double eta2gg  [51] = {-391.708,150.738945650530209,1133.69,-606.88065077172610,-397.419,443.46632493595081,-418.8615955811176,63.17672143745260,19.1527962905383,-5.28419299525808,15.4513682569184,-7.08015,10.65700469009879,-5.45655,7.50379043375379,-4.04896,5.44556070156369,-3.05598,4.06401460115903,-2.36542,3.1072107405633,-1.87626,2.42489543159263,-1.52118,1.92551480828889,-1.25714,1.55163866045351,-1.05638,1.26614972098521,-0.900665887025046,1.04437275659854,-0.777712923688004,0.86947623068792,-0.679070394383943,0.72970988810285,-0.598796436684565,0.616699,-0.53263051648115,0.524361,-0.47746215477987,0.448206,-0.43098279612817,0.38486709485788,-0.39145308112284,0.33178637249572,-0.35754432652039,0.28699518377251,-0.32822865360605,0.24896168009960,-0.30270159455257,0.21648138058622};
  double eta2ggL1[51] = {174.15750437473244,327.348518152388038,-518.79043104426378,-315.064,327.75070558396172,-150.466,71.32861746606162,90.0795,-20.3364,26.13414362291716,-8.41338,11.61167032841260,-4.51694,6.13557105792635,-2.84254,3.57056004158133,-1.98082,2.20934812405210,-1.478583377831954,1.42384420875010,-1.15852,0.94222134381112,-0.940542,0.63307433446364,-0.784315,0.42745,-0.667777402101062,0.286786,-0.578017718425837,0.18838,-0.507060013905681,0.11829961193526,-0.449748081142345,0.06768547707731,-0.40261908077919,0.03073580012495,-0.36327056482420,0.00355265737385,-0.32998850014340,-0.0165412,-0.30152,-0.0314204,-0.27693,-0.0424199,-0.255506,-0.05050491440783,-0.236698,-0.05638238581056,-0.220076,-0.06057639456474,-0.20529444180416};
  double eta2ggL2[51] = {-29.416929742702180,-105.839112060572947,36.196077353479670,141.88273823194094,-10.2664,-6.09362617136800,12.2317,-15.617460317460317,-1.25456,-4.436111111111111,-1.171362433862434,-2.249422799422799,-0.8972643097643097,-1.388769563769564,-0.6876877751877752,-0.951171051171051,-0.538366,-0.695319304878128,-0.431008,-0.531756458768843,-0.352056,-0.420444288826642,-0.292602970215199,-0.341085417825221,-0.246844837720124,-0.282429509214406,-0.210936,-0.237806,-0.182269,-0.203044,-0.159036,-0.175424,-0.139954500972530,-0.153105,-0.124097230365838,-0.134807562590884,-0.110779787232586,-0.119616767232991,-0.099489507374569,-0.106864762282719,-0.089836302723299,-0.096054538577003,-0.081519258717590,-0.086809882228875,-0.074303337901944,-0.078841696212655,-0.068002858310572,-0.071924812922650,-0.062469594761105,-0.065881715021147,-0.057584087125352};
  //
  double eta2qg  [51] = {-19.1186,22.2049133517046530,80.5171,25.316758968989261,-69.7797,-42.562872628444643,9.591082468363549,-1.46662041875813,3.225613501582644,0.03658424259065,1.01301501969149,0.27798105679855,0.381663134838223,0.25287813185195,0.129016531338120,0.187063,0.011244912139715,0.126954,-0.0480638,0.07993,-0.0788882,0.04478632324569,-0.0947322,0.01891217256382,-0.10228001399671,-0.0000490402,-0.10507439483704,-0.0139215,-0.105093,-0.0240513,-0.103482,-0.03141764300050,-0.10093,-0.03673151897806,-0.09785492003103,-0.04051172394959,-0.094518,-0.04313929627491,-0.0910819,-0.04489630448939,-0.0876485,-0.0459932,-0.08428081826946,-0.0465883,-0.08101684384165,-0.0468014,-0.07787838149625,-0.04672386047858,-0.07487663273395,-0.04642580991448,-0.07201590298427};
  double eta2qgL1[51] = {46.1294564810594002,26.0743440973095836,-64.182108656198066,-57.129400293469445,8.41534,33.0752859974742811,9.33964,2.96202,2.66878,0.503502,1.03922,-0.0119638,0.418546488711366,-0.172577,0.145139241875212,-0.221034,0.014437513030808,-0.228561,-0.050676361554256,-0.220461019758146,-0.08323115301023,-0.206700294403312,-0.098733112131341,-0.191434798063079,-0.104980749861778,-0.176422129057704,-0.106107601484747,-0.162373739927563,-0.104394268143285,-0.149530175793571,-0.101137360595573,-0.137919050124233,-0.097089780701678,-0.127475,-0.09269419739462,-0.118096,-0.08821165252636,-0.109673,-0.08379469759007,-0.102096267302543,-0.079530115900679,-0.095268486837856,-0.075464444300667,-0.0891009,-0.07161950447980,-0.0835154,-0.06800199649961,-0.078444,-0.06460949246851,-0.07382730173719,-0.06143421039979};
  double eta2qgL2[51] = {-12.199281212138437,-10.0838549606620491,14.527411881059194,16.778040859587899,5.083906368116280,-2.1025192322591833,-3.0611111111111111,-1.2896825396825397,-1.1908068783068783,-0.7132495590828924,-0.666093474426808,-0.4590628507295174,-0.4316518358185025,-0.320716783216783,-0.303535353535354,-0.236783586783587,-0.225370231620232,-0.181992775742776,-0.174050033118661,-0.144245622225498,-0.138505953063487,-0.117136420845141,-0.112858572456096,-0.097011284616166,-0.0937399,-0.081661176987264,-0.0791047,-0.0696864,-0.0676513,-0.0601652,-0.058518970741193,-0.0524701,-0.051119893895432,-0.046162283957751,-0.045041296903251,-0.040927271038751,-0.039986466917602,-0.036534851792205,-0.035737636098833,-0.032813431833040,-0.032132038053091,-0.029632977584411,-0.029046032800847,-0.026893495975056,-0.026384334190630,-0.024517074925942,-0.024072547013104,-0.022442280054382,-0.022051900157650,-0.020620142837501,-0.020275466852380};
  //
  double eta2qqb  [51] = {11.6764,26.1785194667163402,1.81247,-39.160512909567147,-32.1112,4.274671544350231,14.566597237091594,5.959118375922836,2.5300247194142418,1.8196096605690998,1.1692997829588800,0.8987754560587868,0.648106,0.5176817664616875,0.394049,0.322509,0.253213,0.210564,0.1684620521729544,0.141499,0.1144353229303381,0.0966285,0.0784862331444359,0.066325,0.053763781869781,0.0452372,0.036315258353478,0.030211591554644,0.023743760290135,0.019302197839167,0.014535762791102,0.011262038031804,0.007702844352292,0.005266439098158,0.002580892590713,0.000755261650215,-0.001287297511069,-0.002660784452159,-0.004223185929977,-0.005257691254778,-0.006456984616839,-0.007234565717259,-0.008156246193634,-0.008737270804838,-0.009444675913359,-0.009874128076624,-0.010414775649479,-0.010726560941972,-0.011136504856686,-0.011356440772090,-0.011663315184204};
  double eta2qqbL1[51] = {-6.3410961228825368,-16.8681,-10.0471953062135134,11.3262,19.124241263957473,9.60168,0.634772587453437,-0.803936075511031,-0.309175448491032,-0.316021164183356,-0.266383444839742,-0.256915427396636,-0.230643879263176,-0.216677834464688,-0.197185696299818,-0.183870544431701,-0.1686840674799704,-0.1572344296620935,-0.1452202156120987,-0.1356701864256821,-0.1260466739814113,-0.1181333006518629,-0.11032891894296085,-0.1037548916022104,-0.0973492433837204,-0.0918539046702325,-0.0865363472181588,-0.0819079534053275,-0.0774470630120890,-0.0735181518701455,-0.0697397096009365,-0.0663789,-0.0631501980950877,-0.0602542,-0.057473104624715,-0.0549605,-0.0525473,-0.0503533,-0.0482455,-0.0463183,-0.0444658,-0.042763696748928,-0.041126378238395,-0.039615417598287,-0.038160833350609,-0.036813172701544,-0.035514756322210,-0.034307460823861,-0.033143326964517,-0.032057353251179,-0.031009341360714};
  double eta2qqbL2[51] = {0.739707,2.08826837964426215,1.76289,0.0287272901097998,-0.780372,-0.7281067808651730,-0.5555555555555556,-0.3841269841269841,-0.2849206349206349,-0.2194885361552028,-0.174074074074074,-0.1413339746673080,-0.1169873336540003,-0.098407148407148,-0.083913617246951,-0.072394272394272,-0.063089688089688,-0.055467571644042,-0.049146097185313,-0.043845725424673,-0.039358062913274,-0.035525223734718,-0.032225840894572,-0.029365391226566,-0.026869380301875,-0.024678461634983,-0.022744887962279,-0.021029895136175,-0.019501748922039,-0.018134269590208,-0.016905705334824,-0.015797863406317,-0.014795433753226,-0.013885457948306,-0.013056908811996,-0.012300355137167,-0.011607692387262,-0.010971924942513,-0.010386988921561,-0.009847607164429,-0.009349169875486,-0.008887635866669,-0.008459450436344,-0.008061476757181,-0.007690938292186,-0.007345370258964,-0.007022578553319,-0.006720604850387,-0.006437696844046,-0.006172282777939,-0.005922949575212};
  //
  double eta2qq  [51] = {3.29129,2.61453522627805117,-5.27421,-4.7132017680884678,0.394912,1.9244819571233036,2.55786454638810880,1.5554098049754893,0.87917673485958641,0.6462146464442132,0.3974920929882447,0.2957266341374127,0.1837691849069196,0.134687962720938,0.078321517203423,0.053031448078356,0.022497397480064,0.008953816821440,-0.008400278620868,-0.015740623476003,-0.025892598152176,-0.029789538354404,-0.035797463246745,-0.037712961514922,-0.041241079968486,-0.041988558318370,-0.043988224068901,-0.044038250928677,-0.045075309506685,-0.0447086,-0.045130677219689,-0.0445188,-0.044545105274401,-0.0437948,-0.043566559534303,-0.042744876142092,-0.042354801426205,-0.041504283361004,-0.041013860036140,-0.040161374263473,-0.039611869725388,-0.038774220369051,-0.038193476128478,-0.037380921897369,-0.036787753987443,-0.036006265898133,-0.035413350652214,-0.034666082101299,-0.034081878954354,-0.033370134401594,-0.032800185041716};
  double eta2qqL1[51] = {-3.4792801009173208,-6.52482,0.1414116183337336,6.67531,5.2096207865808126,2.60558,0.9590524228443837,0.1404495799857358,-0.0091166595433539,-0.1363621400798876,-0.1629148969267492,-0.1862831789866094,-0.182444,-0.1811073692645928,-0.170761,-0.1633390868632060,-0.152611,-0.144281804944763,-0.134709,-0.126965184623558,-0.118793,-0.111997894355925,-0.105111412246266,-0.099266687559707,-0.093470322444032,-0.088470909535394,-0.083573827540663,-0.079294418553467,-0.075133151004135,-0.071456953011790,-0.067897829172424,-0.064724472360665,-0.061660064298825,-0.058906087557317,-0.056250470201793,-0.053847398317201,-0.051531763832477,-0.0494237,-0.047392672033536,-0.0455338,-0.043742725152773,-0.0420956,-0.040508025430626,-0.039041788601549,-0.037627883577097,-0.036316995839325,-0.035052170461984,-0.033875388655985,-0.032739237519192,-0.031678795670882,-0.030654282117402};
  double eta2qqL2[51] = {0.739707,2.08826837964426215,1.76289,0.0287272901097998,-0.780372,-0.7281067808651730,-0.5555555555555556,-0.3841269841269841,-0.2849206349206349,-0.2194885361552028,-0.174074074074074,-0.1413339746673080,-0.1169873336540003,-0.098407148407148,-0.083913617246951,-0.072394272394272,-0.063089688089688,-0.055467571644042,-0.049146097185313,-0.043845725424673,-0.039358062913274,-0.035525223734718,-0.032225840894572,-0.029365391226566,-0.026869380301875,-0.024678461634983,-0.022744887962279,-0.021029895136175,-0.019501748922039,-0.018134269590208,-0.016905705334824,-0.015797863406317,-0.014795433753226,-0.013885457948306,-0.013056908811996,-0.012300355137167,-0.011607692387262,-0.010971924942513,-0.010386988921561,-0.009847607164429,-0.009349169875486,-0.008887635866669,-0.008459450436344,-0.008061476757181,-0.007690938292186,-0.007345370258964,-0.007022578553319,-0.006720604850387,-0.006437696844046,-0.006172282777939,-0.005922949575212};
  //
  double eta2qqp  [51] = {3.38765,3.00004857944602693,-4.72985,-4.4827187473455982,0.199112,1.6193780483017670,2.3416181973526821,1.41953,0.7888151342001473,0.58339,0.352111178037217,0.261875,0.1578286764240053,0.114355075406488,0.062075026396312,0.039834649670754,0.011624041136153,-0.000117271362816,-0.016051106931331,-0.022256482000821,-0.031490118201217,-0.034635679125442,-0.040022631585878,-0.041420250642988,-0.044512887495514,-0.044891401219634,-0.046576291875549,-0.046356062049747,-0.047159720888676,-0.046590368448297,-0.046835550892315,-0.046068606793443,-0.045958316672080,-0.045087196886005,-0.044751786315030,-0.043834589445273,-0.043359132513367,-0.042432044174465,-0.041872745213668,-0.040958127830978,-0.040352423372630,-0.039463808728044,-0.038836733336139,-0.037981962845794,-0.037350242982984,-0.036533474917099,-0.035908208961570,-0.035131218680892,-0.034519658893230,-0.033782690229951,-0.033189443790408};
  double eta2qqpL1[51] = {-3.4792801009173208,-6.52482,0.1414116183337336,6.67531,5.2096207865808126,2.60558,0.9590524228443837,0.1404495799857358,-0.0091166595433539,-0.1363621400798876,-0.1629148969267492,-0.1862831789866094,-0.182444,-0.1811073692645928,-0.170761,-0.1633390868632060,-0.152611,-0.144281804944763,-0.134709,-0.126965184623558,-0.118793,-0.111997894355925,-0.105111412246266,-0.099266687559707,-0.093470322444032,-0.088470909535394,-0.083573827540663,-0.079294418553467,-0.075133151004135,-0.071456953011790,-0.067897829172424,-0.064724472360665,-0.061660064298825,-0.058906087557317,-0.056250470201793,-0.053847398317201,-0.051531763832477,-0.0494237,-0.047392672033536,-0.0455338,-0.043742725152773,-0.0420956,-0.040508025430626,-0.039041788601549,-0.037627883577097,-0.036316995839325,-0.035052170461984,-0.033875388655985,-0.032739237519192,-0.031678795670882,-0.030654282117402};
  double eta2qqpL2[51] = {0.739707,2.08826837964426215,1.76289,0.0287272901097998,-0.780372,-0.7281067808651730,-0.5555555555555556,-0.3841269841269841,-0.2849206349206349,-0.2194885361552028,-0.174074074074074,-0.1413339746673080,-0.1169873336540003,-0.098407148407148,-0.083913617246951,-0.072394272394272,-0.063089688089688,-0.055467571644042,-0.049146097185313,-0.043845725424673,-0.039358062913274,-0.035525223734718,-0.032225840894572,-0.029365391226566,-0.026869380301875,-0.024678461634983,-0.022744887962279,-0.021029895136175,-0.019501748922039,-0.018134269590208,-0.016905705334824,-0.015797863406317,-0.014795433753226,-0.013885457948306,-0.013056908811996,-0.012300355137167,-0.011607692387262,-0.010971924942513,-0.010386988921561,-0.009847607164429,-0.009349169875486,-0.008887635866669,-0.008459450436344,-0.008061476757181,-0.007690938292186,-0.007345370258964,-0.007022578553319,-0.006720604850387,-0.006437696844046,-0.006172282777939,-0.005922949575212};
  //
}
 

double C2reg_pointlike_gg_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NNLOcoeffs_05::eta2gg  [i] * pow(1-2*z,i);
    res += NNLOcoeffs_05::eta2ggL1[i] * pow(1-2*z,i) * lf;
    res += NNLOcoeffs_05::eta2ggL2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C2reg_pointlike_qg_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NNLOcoeffs_05::eta2qg  [i] * pow(1-2*z,i);
    res += NNLOcoeffs_05::eta2qgL1[i] * pow(1-2*z,i) * lf;
    res += NNLOcoeffs_05::eta2qgL2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C2reg_pointlike_qqb_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NNLOcoeffs_05::eta2qqb  [i] * pow(1-2*z,i);
    res += NNLOcoeffs_05::eta2qqbL1[i] * pow(1-2*z,i) * lf;
    res += NNLOcoeffs_05::eta2qqbL2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C2reg_pointlike_qq_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NNLOcoeffs_05::eta2qq  [i] * pow(1-2*z,i);
    res += NNLOcoeffs_05::eta2qqL1[i] * pow(1-2*z,i) * lf;
    res += NNLOcoeffs_05::eta2qqL2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}
double C2reg_pointlike_qqp_midexp (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += NNLOcoeffs_05::eta2qqp  [i] * pow(1-2*z,i);
    res += NNLOcoeffs_05::eta2qqpL1[i] * pow(1-2*z,i) * lf;
    res += NNLOcoeffs_05::eta2qqpL2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res / (1-z)/(1-z)/z/z/16.;
}

double C2reg_pointlike_gg_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta2[51], eta2L1[51], eta2L2[51];
  for(int p=0; p<=truncation; p++) {
    eta2  [p] = 0;
    eta2L1[p] = 0;
    eta2L2[p] = 0;
    for(int k=0; k<=p; k++) {
      eta2  [p] += NNLOcoeffs_05::eta2gg  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L1[p] += NNLOcoeffs_05::eta2ggL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L2[p] += NNLOcoeffs_05::eta2ggL2[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta2  [i] * pow(1-2*z,i);
    res += eta2L1[i] * pow(1-2*z,i) * lf;
    res += eta2L2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qg_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta2[51], eta2L1[51], eta2L2[51];
  for(int p=0; p<=truncation; p++) {
    eta2  [p] = 0;
    eta2L1[p] = 0;
    eta2L2[p] = 0;
    for(int k=0; k<=p; k++) {
      eta2  [p] += NNLOcoeffs_05::eta2qg  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L1[p] += NNLOcoeffs_05::eta2qgL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L2[p] += NNLOcoeffs_05::eta2qgL2[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta2  [i] * pow(1-2*z,i);
    res += eta2L1[i] * pow(1-2*z,i) * lf;
    res += eta2L2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qqb_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta2[51], eta2L1[51], eta2L2[51];
  for(int p=0; p<=truncation; p++) {
    eta2  [p] = 0;
    eta2L1[p] = 0;
    eta2L2[p] = 0;
    for(int k=0; k<=p; k++) {
      eta2  [p] += NNLOcoeffs_05::eta2qqb  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L1[p] += NNLOcoeffs_05::eta2qqbL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L2[p] += NNLOcoeffs_05::eta2qqbL2[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta2  [i] * pow(1-2*z,i);
    res += eta2L1[i] * pow(1-2*z,i) * lf;
    res += eta2L2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qq_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta2[51], eta2L1[51], eta2L2[51];
  for(int p=0; p<=truncation; p++) {
    eta2  [p] = 0;
    eta2L1[p] = 0;
    eta2L2[p] = 0;
    for(int k=0; k<=p; k++) {
      eta2  [p] += NNLOcoeffs_05::eta2qq  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L1[p] += NNLOcoeffs_05::eta2qqL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L2[p] += NNLOcoeffs_05::eta2qqL2[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta2  [i] * pow(1-2*z,i);
    res += eta2L1[i] * pow(1-2*z,i) * lf;
    res += eta2L2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res;
}
double C2reg_pointlike_qqp_midexpplain (double z, int nf, double muF_mH_ratio, int truncation) {
  double lf = -2*log(muF_mH_ratio); // = log(mH2/muF2)
  double eta2[51], eta2L1[51], eta2L2[51];
  for(int p=0; p<=truncation; p++) {
    eta2  [p] = 0;
    eta2L1[p] = 0;
    eta2L2[p] = 0;
    for(int k=0; k<=p; k++) {
      eta2  [p] += NNLOcoeffs_05::eta2qqp  [k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L1[p] += NNLOcoeffs_05::eta2qqpL1[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
      eta2L2[p] += NNLOcoeffs_05::eta2qqpL2[k] * (1+pow(-1.,p-k)) * (2+p-k)/4.;
    }
  }
  double res = 0;
  //
  for(int i=0; i<=truncation; i++) {
    res += eta2  [i] * pow(1-2*z,i);
    res += eta2L1[i] * pow(1-2*z,i) * lf;
    res += eta2L2[i] * pow(1-2*z,i) * lf*lf;
  }
  return res;
}



const double _zthr1_ = 0.6;
double C2reg_pointlike_gg_softmidexp (double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C2reg_pointlike_gg_softexp(z, nf, muF_mH_ratio);
  else               res = C2reg_pointlike_gg_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C2reg_pointlike_qg_softmidexp (double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C2reg_pointlike_qg_softexp(z, nf, muF_mH_ratio);
  else               res = C2reg_pointlike_qg_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C2reg_pointlike_qqb_softmidexp(double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C2reg_pointlike_qqb_softexp(z, nf, muF_mH_ratio);
  else               res = C2reg_pointlike_qqb_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C2reg_pointlike_qq_softmidexp (double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C2reg_pointlike_qq_softexp(z, nf, muF_mH_ratio);
  else               res = C2reg_pointlike_qq_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C2reg_pointlike_qqp_softmidexp(double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C2reg_pointlike_qqp_softexp(z, nf, muF_mH_ratio);
  else               res = C2reg_pointlike_qqp_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C1reg_pointlike_gg_softmidexp (double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C1reg_pointlike_gg_softexp(z, nf, muF_mH_ratio);
  else               res = C1reg_pointlike_gg_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C1reg_pointlike_qg_softmidexp (double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C1reg_pointlike_qg_softexp(z, nf, muF_mH_ratio);
  else               res = C1reg_pointlike_qg_midexpplain (z, nf, muF_mH_ratio);
  return res;
}
double C1reg_pointlike_qqb_softmidexp(double z, int nf, double muF_mH_ratio) {
  double res = 0;
  if     (z>_zthr1_) res = C1reg_pointlike_qqb_softexp(z, nf, muF_mH_ratio);
  else               res = C1reg_pointlike_qqb_midexpplain (z, nf, muF_mH_ratio);
  return res;
}





// Anastasiou-Melnikov
// !!!! -- Apparently wrong scale dependence! -- !!!!
extern "C" {
  double c2regam_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_AM(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2regam_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}

// Harlander-Kilgore
extern "C" {
  double c2reghk_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_HK(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2reghk_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_gg(double z, int nf, double muf_mu_ratio, double mur_muf_ratio) {
  //couble C2 = C2reg_pointlike_AM(z, nf, muf_mu_ratio, mur_muf_ratio)/z;
  //return C2reg_pointlike_HK(z, nf, muf_mu_ratio, mur_muf_ratio);
  double C2 = C2reg_pointlike_HK(z, nf, muf_mu_ratio, mur_muf_ratio)/z;
  double lf = -2.*log(muf_mu_ratio);
  double W1 = 11./2.;
  C2 += ( 72. * pow(log(1-z),3) + (2.*nf - 33. + 108*lf) * pow(log(1-z),2)
	  + (12.*W1 + 67. - 90.*ZETA2 - 10./3.*nf + 36.*lf*lf - (33.-2.*nf)*lf) * log(1-z)
	  - 101./3. + 33.*ZETA2 + 351.*ZETA3/2. + nf*(14./9.-2.*ZETA2) -(33.-2.*nf)/4.*lf*lf + (2.*CA*W1+67./2.-5./3.*nf-5.*CA*CA*ZETA2)*lf
	  ) /z;
  C2 -= W1* C1reg_pointlike_gg(z, nf, muf_mu_ratio, mur_muf_ratio);
  return C2;
}



extern "C" {
  double c2reghk_qg_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_HK_qg(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2reghk_qg_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_qg(double z, int nf, double muf_mu_ratio, double mur_muf_ratio) {
  double C2 = C2reg_pointlike_HK_qg(z, nf, muf_mu_ratio, mur_muf_ratio) /z;
  C2 -= 11./2.* C1reg_pointlike_qg(z, nf, muf_mu_ratio, mur_muf_ratio);
  return C2;
}


extern "C" {
  double c2reghk_qqb_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_HK_qqb(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2reghk_qqb_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_qqb(double z, int nf, double muf_mu_ratio, double mur_muf_ratio) {
  double C2 = C2reg_pointlike_HK_qqb(z, nf, muf_mu_ratio, mur_muf_ratio)/z;
  C2 -= 11./2.* C1reg_pointlike_qqb(z, nf, muf_mu_ratio, mur_muf_ratio);
  return C2;
}


extern "C" {
  double c2reghk_qq_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_HK_qq(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2reghk_qq_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_qq(double z, int nf, double muf_mu_ratio, double mur_muf_ratio) {
  return C2reg_pointlike_HK_qq(z, nf, muf_mu_ratio, mur_muf_ratio) /z;
}


extern "C" {
  double c2reghk_qqp_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
extern "C" {
  double c2regam_qqp_(double *z, int *nf, double *muf_mu_rat, double *mur_muf_rat);
}
double C2reg_pointlike_HK_qqp(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2reghk_qqp_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_AM_qqp(double z, int nf, double muf_mu_ratio=1., double mur_muf_ratio=1.) {
  return c2regam_qqp_(&z, &nf, &muf_mu_ratio, &mur_muf_ratio);
}
double C2reg_pointlike_qqp(double z, int nf, double muf_mu_ratio, double mur_muf_ratio) {
  //double C2 = C2reg_pointlike_AM_qqp(z, nf, muf_mu_ratio, mur_muf_ratio)/z;
  return C2reg_pointlike_HK_qqp(z, nf, muf_mu_ratio, mur_muf_ratio)/z;
}


// Mellin transforms
dcomplex C2_pointlike_gg (dcomplex N) {return sigma_NNLO_gg_N(N);}
dcomplex C2_pointlike_qg (dcomplex N) {return sigma_NNLO_qg_N(N);}
dcomplex C2_pointlike_qqb(dcomplex N) {return sigma_NNLO_qqbar_N(N);}
dcomplex C2_pointlike_qq (dcomplex N) {return sigma_NNLO_qq_N(N);}
dcomplex C2_pointlike_qqp(dcomplex N) {return sigma_NNLO_qqprime_N(N);}



// Pseudo scalar delta terms
double deltaPseudoC2reg_gg(double z, int nf) {
  return (495-171*z+nf*(20*z-2))*(1-z)/12./z + (2*nf-27)*log(z)*log(z)/3. + (36+(21+2*nf)*z)*log(z)/z/2.;
}
double deltaPseudoC2reg_qg(double z, int nf) {
  return (173-27*z)*(1-z)/9./z - 28.*log(z)*log(z)/9. + 4*(6+7*z)*log(z)/z/3.;
}
double deltaPseudoC2reg_qqb(double z, int nf) {
  return 16*(10+12*z-nf*(1+z))*(1-z)/27./z + 32.*log(z)*log(z)/27. + 32*(3+8*z-nf*z)*log(z)/z/27.;
}
double deltaPseudoC2reg_qq(double z, int nf) {
  return 8*(37-3*z)*(1-z)/27./z - 64.*log(z)*log(z)/27. + 16*(6+11*z)*log(z)/z/27.;
}
double deltaPseudoC2reg_qqp(double z, int nf) {
  return 8*(11-z)*(1-z)/9./z - 16.*log(z)*log(z)/9. + 16*(2+3*z)*log(z)/z/9.;
}
